var sys=require("util"),assert=require("assert"),XMLHttpRequest=require("../lib/XMLHttpRequest").XMLHttpRequest,xhr=new XMLHttpRequest(),http=require("http");var server=http.createServer(function(c,b){if(c.url==="/redirectingResource"){b.writeHead(303,{Location:"http://localhost:8000/"});b.end();return}var a="Hello World";b.writeHead(200,{"Content-Type":"text/plain","Content-Length":Buffer.byteLength(a),Date:"Thu, 30 Aug 2012 18:17:53 GMT",Connection:"close"});b.write("Hello World");b.end();this.close()}).listen(8000);xhr.onreadystatechange=function(){if(this.readyState==4){assert.equal(xhr.getRequestHeader("Location"),"");assert.equal(xhr.responseText,"Hello World");sys.puts("done")}};try{xhr.open("POST","http://localhost:8000/redirectingResource");xhr.send()}catch(e){console.log("ERROR: Exception raised",e)};