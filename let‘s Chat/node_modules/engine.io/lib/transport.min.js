var EventEmitter=require("events").EventEmitter;var parser=require("engine.io-parser");var util=require("util");var debug=require("debug")("engine:transport");module.exports=Transport;function noop(){}function Transport(a){this.readyState="open";this.discarded=false}util.inherits(Transport,EventEmitter);Transport.prototype.discard=function(){this.discarded=true};Transport.prototype.onRequest=function(a){debug("setting request");this.req=a};Transport.prototype.close=function(a){if("closed"===this.readyState||"closing"===this.readyState){return}this.readyState="closing";this.doClose(a||noop)};Transport.prototype.onError=function(c,b){if(this.listeners("error").length){var a=new Error(c);a.type="TransportError";a.description=b;this.emit("error",a)}else{debug("ignored transport error %s (%s)",c,b)}};Transport.prototype.onPacket=function(a){this.emit("packet",a)};Transport.prototype.onData=function(a){this.onPacket(parser.decodePacket(a))};Transport.prototype.onClose=function(){this.readyState="closed";this.emit("close")};